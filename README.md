# Multiple plotting of modules parameters, acquired by the flash test technique, after different treatments

### Introduction
This programm plots the module parameters versus the irradiance for various module treatment. The parameters are acquired using the flash test method.
<br/>
The module parameters, as well as the I/V curves, are stored in .csv files which names obeys the following format:
- UUUdddd_ddddW_Td.csv with U=[A-Z,-,_] and d=[1-9]. We have:
  - UUUdddd_dddd is the module type. The number of U is unlimited  and the  the number of digits d is limited to 50
  - ddddW is the irradiande in W/m^2. The number of digits d cannot be greater than 4.
  - Td is the treatment label. The numer of digit d is equal to 1.
  
These files are stored in the *FLASHTEST_DIR* and all its sub folders. This path is stored in the  configuration file *Pvcharacterization.yaml* and can be iteractivelly changed. 

The structure of the FLASHTEST_DIR must obeys the following structure:
<pre>FLASHTEST_DIR
├── exp_summary.xlsx
├── pv.db
├── BOREALIS
│   ├── LC-BOREALIS-03_0200W_T0.csv
│   ├── LC-BOREALIS-03_0200W_T1.csv
│   └── ...
├── IVcurves
│   ├── EM7621190702200776_1000W_T0.csv
│   ├── EM7621190702200776_1000W_T3.csv
│   └── ...
├── JINERGY
│   ├── JInergy035
│   │   ├── JINERGY3272023326035_0200W_T0.csv
│   │   ├── JINERGY3272023326035_0200W_T1.csv
│   │   └── ....
│   ├── JInergy060
│   │   ├── JINERGY3272023326060_0200W_T0.csv
│   │   ├── JINERGY3272023326060_0200W_T1.csv
│   │   └──...
│   └── JInergy063
│       ├── JINERGY3272023326063_0200W_T0.csv
│       ├── JINERGY3272023326063_0200W_T1.csv
│       └── ...</pre> 
<br>The *WORKING_DIR* contains the sqlite database *pb.db*, a  database containing the two tables PV_descp and exp_values. THE *WORKING_DIR* also contains .xls files generated by PVcharacterization.

<br>A local configuation file *Pvcharacterization.yaml* is store in the folder: linux: ~/.local/share for linux;
macOS: ~/Library/Application Support for macOS; C:/Users/<USER>/AppData/Roaming for windows.



### Description
</br></br>
The program:
1. Interactevelly defines the *data_folder* where *data_folder* must be locate is the users home directory.
2. Recursivelly builds the list of all .csv file located in the folder *data_folder* and its sub-folders.
3. Interactivelly selects the list modules to be analysed and build the dataframe *df_meta* containing all the data necessary to the plotting of the modules parameters
4. Interactivelly defines the list of tuple [(T(i),T(j))], where T(i) stands for the ieme treatment.
5. Interactivelly convert the symbolic items T(i) into the name of the treatment.
6. For *n_params* parameters interactivelly sectected plots the *n_params* the parameters relative variation between two treatments T(k) and T(h):
    
   $$100\frac{{Para{m_i}(Irradiance(n);T(h),module(m)) - Para{m_i}(Irradiance(n);T(k),module(m))}}{{Para{m_i}(Irradiance(n);T(k),module(m))}}$$
   
### Module description
   
The program relies on the package *PVcharacterization_Utils* containig the following modules:
1. PVcharacterization_GUI 
    - input_treatment_labels
    - select_items
    - select_files
    - select_data_dir
2. PVcharacterization_flashtest 
    - assess_path_folders
    - batch_filename_correction
    - build_files_database
    - build_metadata_dataframe
    - build_modules_filenames
    - build_modules_list
    - correct_filename
    - data_dashboard
    - parse_filename
    - pv_flashtest_pca
    - read_flashtest_file
3. config 
    - GLOBAL
    - change_config_pvcharacterization
    - get_config_dir
4. PVcharacterization_image (not used)
    - crop_image
    - py2gwyddion
    - read_electolum_file
5. PVcharacterization_plot
    - construct_x_y
    - init_plot_diff
    - plot_params 
    - plot_params_diff
    - plot_iv_power
6. PVcharacterization_database
    - add_files_to_database
    - sieve_files
    - suppress_duplicate_database
    - sqlite_to_dataframe
    - df2sqlite
7. PVcharacterization_utils
    - plot_time_schedule
    
### How use the package
1. Create/modify the sqlite database
2. Than you can:
   - Perform PCA analysis
   - I/V curves plotting
   - Parameters plotting
   - ...
   
### How modify the module setting
All the global are defined in the PVcharacterization.yaml file located in the package and are accessible from the dict *GLOBAL*.

### Dependancies:

 - numpy
 - matplotlib
 - openpyxl
 - pandas
 - pandasgui
 - plotly (with nbformat>=4.2.0)
 - pyyaml
 - seaborn
 - sceeninfo
 - tkcalendar
 
<br>Note:
With WIN10 pandasgui requires Visual C++ 2019. You can upgrade Visual C++ using this [site](https://shuchanel.com/resolve-python-pip-error-microsoft-visual-c-14-0-or-greater-is-required/)
    
### Nomenclature:
 - module-type (mod): ex. QCELL-2739, QCELLS901719162417702739
 - parameters (param): ex. Pmax, Voc, Isc, Fill Factor, Rseries (defined in Pvcharacterization.yaml)
 - irradiance (irr): irradiance in W/m^2 (defined in Pvcharacterization.yaml) 
 - treatment (trt): treatment type T0, T1, T2,T2,... (defined in Pvcharacterization.yaml)